### DB RAG API - HTTP Collection
### Use this file with VS Code REST Client extension or similar tools

@base_url = http://localhost:9000
@api_key = dev-api-key-12345

### API Information
GET {{base_url}}/

### Health Check
GET {{base_url}}/health

### Authentication Info
GET {{base_url}}/auth/info

### Initialize System
POST {{base_url}}/initialize
Content-Type: application/json
Authorization: Bearer {{api_key}}

{
  "force_rebuild": false
}

### Natural Language Query - Customer Revenue
POST {{base_url}}/query
Content-Type: application/json
Authorization: Bearer {{api_key}}

{
  "query": "What are the top 5 customers by revenue?",
  "query_type": "natural_language",
  "limit": 10,
  "include_explanation": true
}

### Natural Language Query - Recent Orders
POST {{base_url}}/query
Content-Type: application/json
Authorization: Bearer {{api_key}}

{
  "query": "Show me all orders from the last 30 days",
  "query_type": "natural_language",
  "limit": 20,
  "include_explanation": true
}

### Direct SQL Query
POST {{base_url}}/query
Content-Type: application/json
Authorization: Bearer {{api_key}}

{
  "query": "SELECT * FROM customers LIMIT 5",
  "query_type": "sql",
  "limit": 5,
  "include_explanation": false
}

### List All Tables
GET {{base_url}}/tables
Authorization: Bearer {{api_key}}

### Get All Schema Information
POST {{base_url}}/schema
Content-Type: application/json
Authorization: Bearer {{api_key}}

{
  "include_sample_data": false,
  "sample_limit": 3
}

### Get Specific Table Schema with Sample Data
POST {{base_url}}/schema
Content-Type: application/json
Authorization: Bearer {{api_key}}

{
  "table_name": "customers",
  "include_sample_data": true,
  "sample_limit": 3
}

### Database Statistics
GET {{base_url}}/stats
Authorization: Bearer {{api_key}}

### Error Handling Examples

### Invalid Query Type
POST {{base_url}}/query
Content-Type: application/json
Authorization: Bearer {{api_key}}

{
  "query": "test query",
  "query_type": "invalid_type"
}

### Missing Authorization
POST {{base_url}}/query
Content-Type: application/json

{
  "query": "test query"
}

### Invalid API Key
POST {{base_url}}/query
Content-Type: application/json
Authorization: Bearer invalid-key

{
  "query": "test query"
}
